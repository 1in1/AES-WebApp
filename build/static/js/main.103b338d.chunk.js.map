{"version":3,"sources":["About.js","Box.js","HoverBox.js","First.js","Inverse.js","EditBox.js","Utility.js","Affine.js","SubBytes.js","ShiftRows.js","MixColumns.js","AddRoundKey.js","App.js","TorTalk.js","serviceWorker.js","index.js"],"names":["AboutPage","props","className","href","target","rel","Square","value","toString","Box","data","map","n","i","key","HoverBox","useState","isShown","setIsShown","onMouseEnter","onMouseLeave","under","class","over","FirstPage","Latex","tex","displayMode","input","inverseTable","InverseWidget","val","setVal","for","type","text","onChange","event","valid","parseInt","placeholder","default","id","style","width","EditBox","values","initial","editHandler","m","a","util","toBinArray","b","out","toInt","arr","reverse","reduce","acc","curr","xorVec","andVec","addVec","fn","cols","ATDraw","require","partial","output","join","ATWidget","subs","SubBytesPage","editOpen","setEditOpen","setInput","Inverse","onClick","inByte","v","ShiftRowsPage","Array","length","j","getOutput","getF8MultTable","irredCoeffs","transpose","poly","slice","unshift","pop","k","index","table","texString","times","MultTableDraw","MultTableWidget","MixColumnsPage","rpoly","transp","s","multTables","hasOwnProperty","d","column","l","AddRoundKeyPage","editInputOpen","setEditInputOpen","editKeyOpen","setEditKeyOpen","roundKey","setRoundKey","App","document","title","KatexCssInclude","createElement","head","appendChild","from","Math","floor","random","page","setPage","pageObjects","About","First","SubBytes","ShiftRows","MixColumns","AddRoundKey","TorTalk","to","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","path","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.103b338d.chunk.js","sourcesContent":["import React from 'react'\n\nfunction AboutPage(props) {\n    return (\n        <div className='page'>\n            <h1>AES Web App thing</h1>\n            <p>This is a very small web app written to give me a bit of experience with React more than anything else. It gives an explanation of the AES algorithm that should be more than enough to allow someone with a basic understanding of fields to implement the algorithm themselves (minus key expansion - probably coming soon), but hopefully with a little bit more explanation of what's actually happening to the data. Blue bars to the right of a section indicate a more detailed explanations will appear when the reader hovers over. I'd only written my first line with React two days before starting this, so there could well be things that break! Let me know if this happens :) The source is available on my GitHub <a href='https://github.com/1in1/AES-WebApp' target='_blank' rel='noopener noreferrer' >here</a>.</p>\n            <p>This only covers the encryption direction - obviously all of these steps are invertible, and it is very easy to find their inverses. The <a href='https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf' target='_blank' rel='noopener noreferrer' >FIPS specification</a> has been my information source, and invaluable for writing this.</p>\n            <p>(The site probably doesn't render very well on mobile!!)</p>\n            <br /><br />\n            <p>This is also running as a Tor hidden service on an old phone of mine! It doesn't render amazingly well, but it was interesting to set up. See the 'What is this?' link below :)</p>\n        </div>\n    );\n}\n\nexport default AboutPage;","import React from 'react'\nimport './Box.css'\n\n\n\nconst Square = (props) => (\n    <div className='cell'>{props.value.toString(16)}</div>\n);\n\nfunction Box (props) {\n    return (\n    <div className='box'>\n        {props.data.map((n, i) => \n            <Square key={i} value={n} />\n        )}\n    </div>\n    );\n}\n\nexport default Box;","import React, { useState } from 'react'\n\nfunction HoverBox(props) {\n    const [isShown, setIsShown] = useState(false);\n    return (\n      <div className='hoverable' onMouseEnter={() => setIsShown(true)} onMouseLeave={() => setIsShown(false)}>\n        {props.under}\n        {isShown && <div class='reveal'>{props.over}</div>}\n      </div>\n    );\n}\n\nexport default HoverBox;","import React from 'react'\nimport Box from './Box.js'\nimport HoverBox from './HoverBox.js'\n\nfunction FirstPage(props) {\n  const Latex = props.tex;\n\n  return (\n    <div className='page'>\n      <h2>Prerequisites</h2>\n      <p>For Rijndael, we work in the finite field of order <Latex>$ 2^8 = 256$</Latex>, which we denote <Latex>{'$\\\\mathbb{F}(2^8)$'}</Latex> throughout. This is a pretty large object to try and think about, so it will help us to instead consider an isomorphism to a slightly nicer object. The authors of Rijndael chose to use:</p>\n\n      <HoverBox under={\n      <Latex displayMode={true}>\n        {'$$\\\\mathbb{F}(2^8) \\\\cong \\\\frac{\\\\mathbb{F}(2)[x]}{(x^8 + x^4 + x^3 + x + 1)}$$'}\n      </Latex>\n      } over={<p>Why does this work? <Latex>{'$\\\\mathbb{F}(2)$'}</Latex> is a field by definition, so its polynomial ring is a Euclidian domain. If we can quotient by a polynomial of order 8, then all elements in the quotient have a unique non-zero representative of degree strictly less than 8, so the quotient ring will be of the correct order. Since <Latex>$ x^8 + x^4 + x^3 + x + 1 $</Latex> is a prime element in this ring, this quotient is an integral domain. All finite integral domains are fields, and finite fields are unique up to isomorphism, and so this is the field we want.</p>} />\n\n      <p>It turns out this is a particularly nice object to study for a couple of reasons. Firstly, and most obviously, the width of a byte is 8, so the field has as many elements as there are possible bytes. Via the isomorphism above, we can represent each element as a polynomial of degree strictly less than 8, with coefficients in <Latex>{'$\\\\mathbb{F}(2)$'}</Latex>, which may be stored as a single byte. Here we will represent numbers in this field like this, with the bytes in green hexadecimal, e.g.</p>\n\n      <Latex displayMode={true}>{'$x^5 + x^3 + x^2 = {\\\\color{green}\\\\{1c\\\\}}$'}</Latex>\n\n      <p>We also note that each element is its own additive inverse; this is again immediately clear by thinking about the isomorphism. The really useful reason for writing our elements out in this form is that addition is exactly the same operation as XOR'ing the corresponding byte representation. This makes calculations very, very fast.</p>\n\n      <HoverBox under={<p>Rijndael works on two-dimensional blocks, which each have four rows and a fixed number of columns. The typical number of columns is four, so we chunk our plaintext into blocks of 16 bytes, and encrypt each block individually. We call this array the <i>state</i> when describing the algorithm. The box below represents a state of the algorithm - you can edit these to see how the algorithm behaves on different data.</p>}\n      over={<p>We fill the state matrix by going down each column in turn, working left to right. We DON'T fill the state matrix by going across each row, working top to bottom. If we want to extend the algorithm to other modes which work on longer (or even indeterminate) length rows, this is essential.</p>} />\n\n      <div className='boxContainerOuter'>\n        <div className='boxContainerInner'>State:\n          <Box data={props.input} />\n        </div>\n      </div>\n      \n      <HoverBox under={<p>As with all encryption schemes, we begin with two pieces of information: the <i>plaintext</i> and the <i>key</i>. The cipher consist of several rounds of the same four basic operations. To this end, we expand a given key into several, and one is used for each round - this is called <i>key expansion</i>, and produces a set of <i>round keys</i>. The algorithm consists of the following steps, in the following order:</p>}\n      over={<p>Key expansion is where the 128-, 192- and 256-bit key variants of AES differ. The larger the key, the less the risk of reproducing part of the round keys from knowing part of the original key.</p>} />\n\n      <div className='listContainer'><ul>\n        <li>Add Round Key</li>\n        <ul>\n          -Repeat-\n          <li>Sub Bytes</li>\n          <li>Shift Rows</li>\n          <li>Mix Colums</li>\n          <li>Add Round Key</li>\n          -9 times-\n        </ul>\n        <li>Sub Bytes</li>\n        <li>Shift Rows</li>\n        <li>Add Round Key</li>\n      </ul></div>\n      <p>Note that we don't mix columns on the final round; it adds no extra diffusion. Note also that 10 rounds is relatively arbitrary - extra rounds were added during the design competition as a buffer to mitigate a known attack.</p>\n    </div>\n  );\n}\n\nexport default FirstPage;","import React, { useState } from 'react'\n\nconst inverseTable = [0x00, 0x01, 0x8D, 0xF6, 0xCB, 0x52, 0x7B, 0xD1, 0xE8, 0x4F, 0x29, 0xC0, 0xB0, 0xE1, 0xE5, 0xC7, 0x74, 0xB4, 0xAA, 0x4B, 0x99, 0x2B, 0x60, 0x5F, 0x58, 0x3F, 0xFD, 0xCC, 0xFF, 0x40, 0xEE, 0xB2, 0x3A, 0x6E, 0x5A, 0xF1, 0x55, 0x4D, 0xA8, 0xC9, 0xC1, 0x0A, 0x98, 0x15, 0x30, 0x44, 0xA2, 0xC2, 0x2C, 0x45, 0x92, 0x6C, 0xF3, 0x39, 0x66, 0x42, 0xF2, 0x35, 0x20, 0x6F, 0x77, 0xBB, 0x59, 0x19, 0x1D, 0xFE, 0x37, 0x67, 0x2D, 0x31, 0xF5, 0x69, 0xA7, 0x64, 0xAB, 0x13, 0x54, 0x25, 0xE9, 0x09, 0xED, 0x5C, 0x05, 0xCA, 0x4C, 0x24, 0x87, 0xBF, 0x18, 0x3E, 0x22, 0xF0, 0x51, 0xEC, 0x61, 0x17, 0x16, 0x5E, 0xAF, 0xD3, 0x49, 0xA6, 0x36, 0x43, 0xF4, 0x47, 0x91, 0xDF, 0x33, 0x93, 0x21, 0x3B, 0x79, 0xB7, 0x97, 0x85, 0x10, 0xB5, 0xBA, 0x3C, 0xB6, 0x70, 0xD0, 0x06, 0xA1, 0xFA, 0x81, 0x82, 0x83, 0x7E, 0x7F, 0x80, 0x96, 0x73, 0xBE, 0x56, 0x9B, 0x9E, 0x95, 0xD9, 0xF7, 0x02, 0xB9, 0xA4, 0xDE, 0x6A, 0x32, 0x6D, 0xD8, 0x8A, 0x84, 0x72, 0x2A, 0x14, 0x9F, 0x88, 0xF9, 0xDC, 0x89, 0x9A, 0xFB, 0x7C, 0x2E, 0xC3, 0x8F, 0xB8, 0x65, 0x48, 0x26, 0xC8, 0x12, 0x4A, 0xCE, 0xE7, 0xD2, 0x62, 0x0C, 0xE0, 0x1F, 0xEF, 0x11, 0x75, 0x78, 0x71, 0xA5, 0x8E, 0x76, 0x3D, 0xBD, 0xBC, 0x86, 0x57, 0x0B, 0x28, 0x2F, 0xA3, 0xDA, 0xD4, 0xE4, 0x0F, 0xA9, 0x27, 0x53, 0x04, 0x1B, 0xFC, 0xAC, 0xE6, 0x7A, 0x07, 0xAE, 0x63, 0xC5, 0xDB, 0xE2, 0xEA, 0x94, 0x8B, 0xC4, 0xD5, 0x9D, 0xF8, 0x90, 0x6B, 0xB1, 0x0D, 0xD6, 0xEB, 0xC6, 0x0E, 0xCF, 0xAD, 0x08, 0x4E, 0xD7, 0xE3, 0x5D, 0x50, 0x1E, 0xB3, 0x5B, 0x23, 0x38, 0x34, 0x68, 0x46, 0x03, 0x8C, 0xDD, 0x9C, 0x7D, 0xA0, 0xCD, 0x1A, 0x41, 0x1C];\n\n\nfunction InverseWidget(props) {\n    const [val, setVal] = useState('00');\n    return (\n        <div class='inverse'>\n            <label for='inverseInput'>Try it - inverse of: </label>\n            <input \n                type='text' \n                value={val.text}\n                onChange={event => {\n                    if(event.target.value==='') {\n                        setVal({text: '', valid: false});\n                    } else {\n                        let i = parseInt(event.target.value, 16);\n                        if(i>=0 && i < 256){\n                            setVal({text: event.target.value, valid: true});\n                        }\n                    }\n                }}\n                placeholder={props.default}\n                id='inverseInput' \n                style={{width: 20}} />\n            <p>{val.valid && \n            inverseTable[parseInt(val.text, 16)].toString(16)}</p>\n        </div>\n    );\n}\n\nexport default InverseWidget;","import React from 'react'\n\nfunction EditBox(props) {\n    const values = props.initial.map(n => n.toString(16));\n    return (\n    <div className='editBox'>\n        {values.map((n, i) => \n            <div className='cell'>\n            <input type='text'\n            value={n}\n            onChange={event => {\n                if(event.target.value==='') {\n                    values[i]='00';\n                    props.editHandler(values.map(m => parseInt(m, 16)));\n                } else {\n                    let a = parseInt(event.target.value, 16);\n                    if(a >=0 && a < 256) {\n                        values[i]=event.target.value;\n                        props.editHandler(values.map(m => parseInt(m, 16)));\n                    }\n                }\n            }}\n            />\n            </div>\n        )}\n    </div>\n    );\n}\n\nexport default EditBox;","const util = {\n    toBinArray: (b) => {\n        let out = [];\n        for(let i=0; i<8; i++)\n            out[i] = (b>>i)&1;\n        return out;\n    },\n    toInt: (arr) => {\n        return arr.reverse().reduce((acc, curr) => 2*acc + curr);\n    },\n    xorVec: (a, b) => {\n        let out = [];\n        for(let i in a)\n            out[i] = a[i]^b[i];\n        return out;\n    },\n    andVec: (a, b) => {\n        let out = [];\n        for(let i in a)\n            out[i] = a[i]&b[i];\n        return out;\n    },\n    addVec: (a, b, fn) => {\n        let out = [];\n        for(let i in a)\n            out[i] = fn(a[i], b[i]);\n        return out;\n    },\n}\n\nexport default util;","import React, { useState } from 'react'\nimport util from './Utility.js'\n\nconst cols = [[1, 1, 1, 1, 1, 0, 0, 0], [0, 1, 1, 1, 1, 1, 0, 0], [0, 0, 1, 1, 1, 1, 1, 0], [0, 0, 0, 1, 1, 1, 1, 1], [1, 0, 0, 0, 1, 1, 1, 1], [1, 1, 0, 0, 0, 1, 1, 1], [1, 1, 1, 0, 0, 0, 1, 1], [1, 1, 1, 1, 0, 0, 0, 1]];\n\n\nfunction ATDraw(props) {\n    const Latex = require('react-latex');\n    \n    const input = util.toBinArray(props.value);\n    let partial = [0,0,0,0,0,0,0,0];\n    for(let i in input) {\n        if(input[i]) {\n            partial = util.xorVec(partial, cols[i]);\n        }\n    }\n    const output = util.xorVec(partial, [1, 1, 0, 0, 0, 1, 1, 0]);\n    return (\n        <Latex>{`$$\n            \\\\begin{bmatrix} 1&0&0&0&1&1&1&1\\\\\\\\1&1&0&0&0&1&1&1\\\\\\\\1&1&1&0&0&0&1&1&\\\\\\\\1&1&1&1&0&0&0&1\\\\\\\\1&1&1&1&1&0&0&0\\\\\\\\0&1&1&1&1&1&0&0\\\\\\\\0&0&1&1&1&1&1&0\\\\\\\\0&0&0&1&1&1&1&1 \\\\end{bmatrix}\n            \\\\begin{bmatrix}`+ input.join('\\\\\\\\') + `\\\\end{bmatrix}\n            +\n            \\\\begin{bmatrix} 1\\\\\\\\1\\\\\\\\0\\\\\\\\0\\\\\\\\0\\\\\\\\1\\\\\\\\1\\\\\\\\0 \\\\end{bmatrix}\n            =\n            \\\\begin{bmatrix}` + partial.join('\\\\\\\\') + `\\\\end{bmatrix}\n            +\n            \\\\begin{bmatrix} 1\\\\\\\\1\\\\\\\\0\\\\\\\\0\\\\\\\\0\\\\\\\\1\\\\\\\\1\\\\\\\\0 \\\\end{bmatrix}\n            =\n            \\\\begin{bmatrix}` + output.join('\\\\\\\\') + `\\\\end{bmatrix}\n            = \\\\text{` + util.toInt(output).toString(16) + `}\n        $$`}</Latex>\n    );\n}\n\nfunction ATWidget(props) {\n    const [val, setVal] = useState('00');\n    return (\n        <div class='affine'>\n            <label for='affineInput'>Try it - transform of: </label>\n            <input \n                type='text' \n                value={val.text}\n                onChange={event => {\n                    if(event.target.value==='') {\n                        setVal({text: '', valid: false});\n                    } else {\n                        let i = parseInt(event.target.value, 16);\n                        if(i>=0 && i < 256){\n                            setVal({text: event.target.value, valid: true});\n                        }\n                    }\n                }}\n                placeholder={props.default}\n                id='affineInput' \n                style={{width: 20}} />\n            <p>{val.valid && \n            <ATDraw key={val.text} value={parseInt(val.text, 16)}/>}</p>\n        </div>\n    );\n}\n\nexport default ATWidget;","import React, { useState } from 'react'\nimport Box from './Box.js'\nimport InverseWidget from './Inverse.js'\nimport EditBox from './EditBox.js'\nimport ATWidget from './Affine.js';\nimport HoverBox from './HoverBox.js';\n\n\nconst subs = [0x63 ,0x7c ,0x77 ,0x7b ,0xf2 ,0x6b ,0x6f ,0xc5 ,0x30 ,0x01 ,0x67 ,0x2b ,0xfe ,0xd7 ,0xab ,0x76 ,0xca ,0x82 ,0xc9 ,0x7d ,0xfa ,0x59 ,0x47 ,0xf0 ,0xad ,0xd4 ,0xa2 ,0xaf ,0x9c ,0xa4 ,0x72 ,0xc0 ,0xb7 ,0xfd ,0x93 ,0x26 ,0x36 ,0x3f ,0xf7 ,0xcc ,0x34 ,0xa5 ,0xe5 ,0xf1 ,0x71 ,0xd8 ,0x31 ,0x15 ,0x04 ,0xc7 ,0x23 ,0xc3 ,0x18 ,0x96 ,0x05 ,0x9a ,0x07 ,0x12 ,0x80 ,0xe2 ,0xeb ,0x27 ,0xb2 ,0x75 ,0x09 ,0x83 ,0x2c ,0x1a ,0x1b ,0x6e ,0x5a ,0xa0 ,0x52 ,0x3b ,0xd6 ,0xb3 ,0x29 ,0xe3 ,0x2f ,0x84 ,0x53 ,0xd1 ,0x00 ,0xed ,0x20 ,0xfc ,0xb1 ,0x5b ,0x6a ,0xcb ,0xbe ,0x39 ,0x4a ,0x4c ,0x58 ,0xcf ,0xd0 ,0xef ,0xaa ,0xfb ,0x43 ,0x4d ,0x33 ,0x85 ,0x45 ,0xf9 ,0x02 ,0x7f ,0x50 ,0x3c ,0x9f ,0xa8 ,0x51 ,0xa3 ,0x40 ,0x8f ,0x92 ,0x9d ,0x38 ,0xf5 ,0xbc ,0xb6 ,0xda ,0x21 ,0x10 ,0xff ,0xf3 ,0xd2 ,0xcd ,0x0c ,0x13 ,0xec ,0x5f ,0x97 ,0x44 ,0x17 ,0xc4 ,0xa7 ,0x7e ,0x3d ,0x64 ,0x5d ,0x19 ,0x73 ,0x60 ,0x81 ,0x4f ,0xdc ,0x22 ,0x2a ,0x90 ,0x88 ,0x46 ,0xee ,0xb8 ,0x14 ,0xde ,0x5e ,0x0b ,0xdb ,0xe0 ,0x32 ,0x3a ,0x0a ,0x49 ,0x06 ,0x24 ,0x5c ,0xc2 ,0xd3 ,0xac ,0x62 ,0x91 ,0x95 ,0xe4 ,0x79 ,0xe7 ,0xc8 ,0x37 ,0x6d ,0x8d ,0xd5 ,0x4e ,0xa9 ,0x6c ,0x56 ,0xf4 ,0xea ,0x65 ,0x7a ,0xae ,0x08 ,0xba ,0x78 ,0x25 ,0x2e ,0x1c ,0xa6 ,0xb4 ,0xc6 ,0xe8 ,0xdd ,0x74 ,0x1f ,0x4b ,0xbd ,0x8b ,0x8a ,0x70 ,0x3e ,0xb5 ,0x66 ,0x48 ,0x03 ,0xf6 ,0x0e ,0x61 ,0x35 ,0x57 ,0xb9 ,0x86 ,0xc1 ,0x1d ,0x9e ,0xe1 ,0xf8 ,0x98 ,0x11 ,0x69 ,0xd9 ,0x8e ,0x94 ,0x9b ,0x1e ,0x87 ,0xe9 ,0xce ,0x55 ,0x28 ,0xdf ,0x8c ,0xa1 ,0x89 ,0x0d ,0xbf ,0xe6 ,0x42 ,0x68 ,0x41 ,0x99 ,0x2d ,0x0f ,0xb0 ,0x54 ,0xbb ,0x16];\n\n\nfunction SubBytesPage(props) {\n    const [editOpen, setEditOpen] = useState(false);\n    const [input, setInput] = useState(props.input);\n    const Latex = props.tex;\n\n\n    return (\n        <div className='page'>\n            <h2>Substitute Bytes</h2>\n            <p>The first step in a round of Rijndael is to swap each byte with another. This is conceptually done in two operations. Let <Latex>{'$\\\\color{green}{\\\\{p\\\\}}$'}</Latex> be our input.</p>\n            <p>First, we substitute this with its multiplicative inverse in <Latex>{'$ \\\\mathbb{F}(2^8) $. Of course, $\\\\color{green}{\\\\{00\\\\}}$'}</Latex> has no such inverse, but we define this to be self-inverse to make everything work.</p>\n\n            <InverseWidget default={'00'} />\n\n            <HoverBox under={\n            <p><Latex>{'Let $ {\\\\color{green}\\\\{p\\\\}^{-1}} = {\\\\color{green}\\\\{q\\\\}} $'}</Latex>. Then, we apply a specific affine transformation <Latex>{'$ {\\\\color{green}\\\\{q\\\\}} \\\\mapsto {\\\\color{green}\\\\{r\\\\}} $'}</Latex>. This transformation is best understood as taking the sum of rotations of the byte representing the number, with a constant at the end. The matrix below shows the transformation with respect to the natural basis <Latex>{'$ \\\\{{\\\\color{green}\\\\{01\\\\}}, {\\\\color{green}\\\\{02\\\\}}, {\\\\color{green}\\\\{04\\\\}}, ..., {\\\\color{green}\\\\{80\\\\}}\\\\}$ of $\\\\mathbb{F}(2^8)$.'}</Latex></p>\n            }\n            over={\n                <>\n                    <p>Why is this a \"natural basis\"? What we are doing here is considering <Latex>{'$\\\\mathbb{F}(2^8)$'}</Latex> a vector space over <Latex>{'$\\\\mathbb{F}(2)$'}</Latex>, using the isomorphism from earlier. The choice of basis induced by that map is <Latex>{'$ \\\\{1, x, x^2, ..., x^7\\\\} = \\\\{{\\\\color{green}\\\\{01\\\\}}, {\\\\color{green}\\\\{02\\\\}}, {\\\\color{green}\\\\{04\\\\}}, ..., {\\\\color{green}\\\\{80\\\\}}\\\\}$'}</Latex>.</p>\n                    <p>What do we mean about the \"sum of rotations\"? Have a think about how we might reformulate this in terms of byte rotations :) </p>\n                </>\n            } />\n\n            <Latex displayMode={true}>{`$$\n                \\\\begin{bmatrix} r_0\\\\\\\\r_1\\\\\\\\r_2\\\\\\\\r_3\\\\\\\\r_4\\\\\\\\r_5\\\\\\\\r_6\\\\\\\\r_7 \\\\end{bmatrix}\n                =\n                \\\\begin{bmatrix} 1&0&0&0&1&1&1&1\\\\\\\\1&1&0&0&0&1&1&1\\\\\\\\1&1&1&0&0&0&1&1&\\\\\\\\1&1&1&1&0&0&0&1\\\\\\\\1&1&1&1&1&0&0&0\\\\\\\\0&1&1&1&1&1&0&0\\\\\\\\0&0&1&1&1&1&1&0\\\\\\\\0&0&0&1&1&1&1&1 \\\\end{bmatrix}\n                \\\\begin{bmatrix} q_0\\\\\\\\q_1\\\\\\\\q_2\\\\\\\\q_3\\\\\\\\q_4\\\\\\\\q_5\\\\\\\\q_6\\\\\\\\q_7 \\\\end{bmatrix}\n                +\n                \\\\begin{bmatrix} 1\\\\\\\\1\\\\\\\\0\\\\\\\\0\\\\\\\\0\\\\\\\\1\\\\\\\\1\\\\\\\\0 \\\\end{bmatrix}\n            $$`}</Latex>\n\n            <p>The widget below implements this transformation.</p>\n            <ATWidget default={'00'} />\n            \n            <p>In practice, unless we have severe constraints on the amount of data we can store (think embedded systems), we simply store a table of the result of applying both operations consecutively, and look up the value to substitute, for efficiency reasons.</p>\n            <p>It's also worth bearing in mind that this substition doesn't necessarily need to be exactly the one given here. The authors of Rijndael chose this one because it gives resistance against both differential and linear cryptanalysis techniques, but other suitable substitutions may be used - this is good reason to believe the NSA didn't build in a back door in the specification!</p>\n            <p>Try the whole SubBytes step below - click anywhere on the state box to edit the initial values.</p>\n\n\n            <div className='boxContainerOuter'>\n                <div className='boxContainerInner' onClick={() => setEditOpen(true)}>State:\n                    <Box key={'in'+input.toString()} data={input} /></div>\n                <div className='boxContainerInner'>Output:\n                    <Box key={'out'+input.toString()}\n                    data={input.map( inByte => subs[inByte])} />\n                </div>\n            </div>\n\n            {editOpen && \n            <div><div className='fadeBackground'\n            onClick={() => setEditOpen(false)}></div>\n            <div className='editBoxContainer'>\n                <EditBox initial={input} editHandler={(v) => {\n                    setInput(v);\n                }}/>\n            </div></div>\n            }\n        </div>\n    );\n}\n\nexport default SubBytesPage;","import React, { useState } from 'react'\nimport Box from './Box.js'\nimport EditBox from './EditBox.js'\n\n\nfunction ShiftRowsPage(props) {\n    const Latex = props.tex;\n    const [editOpen, setEditOpen] = useState(false);\n    const [input, setInput] = useState(props.input);\n\n    const getOutput = (a) => {\n        const output = Array(a.length);\n        for (let i=0; i<4; i++) {\n            for (let j=0; j<4; j++) {\n                output[4*i + j] = a[4*i + ((j+i) % 4)];\n            }\n        }\n        return output;\n    };\n    \n\n    return (\n        <div className='page'>\n            <h2>Shift Rows</h2>\n            <p>Once we have swapped out elements in the state for others, we want to take each row of the box, and \"rotate\" it. For Rijndael, we move each element in the <Latex>{'$i^{th}$ row $i$'}</Latex> elements to the left, with the ones going past the edge wrapping back around (the top row is row 0!). Note that when we fill our initial state, we are filling column by column, and so this is quite a significant scrambling of the data!</p>\n            <p>Try it out below. Again, the state box can be edited by clicking on it.</p>\n\n\n            <div className='boxContainerOuter'>\n                <div className='boxContainerInner' onClick={() => setEditOpen(true)}>State:\n                    <Box key={'in'+input.toString()} data={input} /></div>\n                <div className='boxContainerInner'>Output:\n                    <Box key={'out'+input.toString()}\n                    data={getOutput(input)} />\n                </div>\n            </div>\n            {editOpen && \n            <div><div className='fadeBackground'\n            onClick={() => setEditOpen(false)}></div>\n            <div className='editBoxContainer'>\n                <EditBox initial={input} editHandler={(v) => {\n                    setInput(v);\n                }}/>\n            </div></div>\n            }\n\n        </div>\n    )\n}\n\n\nexport default ShiftRowsPage;","import React, { useState } from 'react'\nimport Box from './Box.js'\nimport EditBox from './EditBox.js'\nimport util from './Utility.js'\nimport HoverBox from './HoverBox.js';\n\n\nfunction getF8MultTable(n) {\n    const irredCoeffs = [1, 1, 0, 1, 1, 0, 0, 0];\n    const transpose = [];\n    let poly = util.toBinArray(n);\n    transpose[0] = poly.slice(0);\n    for(let i=1; i<8; i++) {\n        poly.unshift(0);\n        if(poly.pop() === 1) {\n            poly = poly.map((k, index) => (k + irredCoeffs[index]) % 2);\n        }\n        transpose[i] = poly.slice(0);\n    }\n\n    const table = new Array(8);\n    for(let i=0; i<8; i++) {\n        table[i] = new Array(8);\n        for(let j=0; j<8; j++) {\n            table[i][j] = transpose[j][i];\n        }\n    }\n\n    return { \n        texString: table.map(k => k.join(' & ')).join('\\\\\\\\\\n'),\n        times: (m) => {\n            let arr = util.toBinArray(m);\n            let out = [0,0,0,0,0,0,0,0];\n            for(let i=0; i<8; i++) {\n                if(arr[i])\n                    out = util.xorVec(out, transpose[i]);\n            }\n            return util.toInt(out);\n        }\n    };\n}\n\n\nfunction MultTableDraw(props) {\n    const Latex = props.tex;\n    return (\n        <Latex className='multTable' displayMode={true}>{'$$\\\\begin{bmatrix}' + getF8MultTable(props.n).texString + '\\\\end{bmatrix} $$'}</Latex>\n    );\n}\nfunction MultTableWidget(props) {\n    const [val, setVal] = useState({text: '', valid: false});\n    return (\n        <div class='multTableWidget'>\n            <label for='multTableInput'>Try it - matrix for: </label>\n            <input \n                type='text' \n                value={val.text}\n                onChange={event => {\n                    if(event.target.value==='') {\n                        setVal({text: '', valid: false});\n                    } else {\n                        let i = parseInt(event.target.value, 16);\n                        if(i>=0 && i < 256){\n                            setVal({text: event.target.value, valid: true});\n                        }\n                    }\n                }}\n                placeholder={props.default}\n                id='inverseInput' \n                style={{width: 20}} />\n            {val.valid && \n                <MultTableDraw key={val.text} n={parseInt(val.text, 16)} tex={props.tex} />\n            }\n        </div>\n    );\n}\n\nfunction MixColumnsPage(props) {\n    const [editOpen, setEditOpen] = useState(false);\n    const [input, setInput] = useState(props.input);\n    const Latex = props.tex;\n\n\n    //We assume we have the polynomial with greatest power of x first\n    const poly = [3, 1, 1, 2];\n    const rpoly = poly.slice(0).reverse();\n    const table = [[],[],[],[]];\n    for(let i=0; i<4; i++) {\n        for(let j=0; j<4; j++) {\n            table[j][i] = rpoly[(3*i+j) % 4];\n        }\n    }\n    const transp = new Array(4);\n    for(let i=0; i<4; i++) {\n        transp[i] = new Array(4);\n        for(let j=0; j<4; j++) {\n            transp[i][j] = table[j][i];\n        }\n    }\n    const s = table.map(k => '\\\\{' + k.join('\\\\} & \\\\{') + '\\\\}').join('\\\\\\\\\\n');\n    const multTables = poly.reduce((acc, curr) => {\n        if(acc && !(acc.hasOwnProperty(curr))) {\n            acc[curr] = getF8MultTable(curr);\n        }\n        return acc;\n    }, {});\n\n\n    const getOutput = (a) => {\n        //For each col we want to calculate (=col in output = col in right matrix)    \n        const output = new Array(a.length);\n        for(let k=0; k<4; k++) {\n            let column = [0, 0, 0, 0];\n            //For each col in the left matrix\n            for(let j=0; j<4; j++) {\n                column = util.addVec(\n                    column, \n                    transp[j].map(n => \n                        multTables[n].times(a[4*j + k])\n                    ),\n                    (a, b) => a^b\n                );\n            }\n            for(let l=0; l<4; l++)\n                output[4*l + k] = column[l];\n        }\n        return output;\n    };\n\n\n    return (\n        <div className='page'>\n            <h2>Mix Columns</h2>\n            <p>Here's where things start to get tricky. We now work in <Latex>{'$\\\\mathbb{F}(2^8)[y]$'}</Latex>, that is, the ring of polynomials with coefficients in <Latex>{'$\\\\mathbb{F}(2^8)$'}</Latex>. We still really want to be thinking in terms of our isomorphism earlier, so the hex notation introduced will now be very helpful for keeping our two variables <Latex>{'$x$ and $y$'}</Latex> apart in our heads.</p>\n            <p>We want to think of each column, in turn, as a polynomial of degree strictly less than 4. To this end, we fix a column, and let its elements be the coefficients in ascending order (i.e., the last value is the coefficient of <Latex>$y^3$</Latex>).</p>\n            <p>Now, just the notion that we are working with polynomials of a maximum degree should indicate we are again thinking about a quotient ring. Here, we are doing all following calculations in: <Latex displayMode={true}>{'$$ R := \\\\frac{\\\\mathbb{F}(2^8)[y]}{ ( {\\\\color{green}\\\\{01\\\\}}y^4 + {\\\\color{green}\\\\{01\\\\}} ) }. $$'}</Latex>\n            For this step of the algorithm, we want to multiply each column by a fixed element of <Latex>$R$</Latex>. In Rijndael, this element is \n            <Latex displayMode={true}>{\n                '$$a(y) = ' + poly.map( (n, d) => \n                    '{\\\\color{green}\\\\{' + n.toString(16) + '\\\\}}\\\\cdot y^{' + (3 - d).toString() + '}'\n                ).join(' + ') + '.$$'\n            }</Latex></p>\n\n\n            <HoverBox under={\n            <p>Of course, this involves multiplying elements in <Latex>{'$\\\\mathbb{F}(2^8)$'}</Latex>, which is certainly not trivial, so we need to get hold of the multiplication tables for each coefficient. It is fairly easy to find the representation of an element of <Latex>{'$\\\\mathbb{F}(2^8)$'}</Latex> as a matrix acting on the vector space <Latex>{'$\\\\mathbb{F}(2)^8$, by considering its action on the standard basis $\\\\{1, x, ..., x^7\\\\}$'}</Latex>. You can enter such an element into the box below to see this representation of it.</p>\n            }\n            over={\n                <>\n                    <p>Why for the coefficients? There are only four of them, and once calculated a single time, they can be reused. Along with the observations below, it should be pretty clear that in all but the most memory-sensitive situations, we should be precalculating these three tables.</p>\n                    <p>See the SubBytes page for an expalanation of why this is a natural basis.</p>\n                </>\n            } />\n\n\n            <MultTableWidget default='00' tex={props.tex} />\n\n            <p>Notice that the coefficients of <Latex>$a$</Latex> make for some very easy calculations! Not only is the identity repeated, <Latex>{'$ {\\\\color{green}\\\\{03\\\\}}$'}</Latex> is just the sum of the other two.</p>\n            \n            <p>Now the particular choice of quotient ring <Latex>$R$</Latex> is very nice - since we saw before that all elements in <Latex>{'$\\\\mathbb{F}(2^8)$'}</Latex> are additively self-inverse, taking this quotient is the same as setting <Latex>{'$ {\\\\color{green}\\\\{01\\\\}}={\\\\color{green}\\\\{01\\\\}}y^4$'}</Latex>, and so the action on each basis element of <Latex>$R$</Latex> is very easy to work out: the vector expression representing the action of <Latex>$a$</Latex> on <Latex>$R$</Latex> viewed as an <Latex>{'$\\\\mathbb{F}(2^8)$'}</Latex> vector space with respect to the basis <Latex>{'$\\\\{{\\\\color{green}\\\\{01\\\\}} , ..., {\\\\color{green}\\\\{01\\\\}}y^3\\\\}$'}</Latex> is:\n                <Latex displayMode={true}>{`$$\n                    \\\\begin{bmatrix} b_0\\\\\\\\b_1\\\\\\\\b_2\\\\\\\\b_3 \\\\end{bmatrix}\n                    =\n                    \\\\begin{bmatrix} ` + s + ` \\\\end{bmatrix}\n                    \\\\begin{bmatrix} a_0\\\\\\\\a_1\\\\\\\\a_2\\\\\\\\a_3 \\\\end{bmatrix},\n                $$`}</Latex>\n            </p>\n\n            <p>Have a play with the boxes below, which will apply the full column mixing transformation.</p>\n\n            <div className='boxContainerOuter'>\n                <div className='boxContainerInner' onClick={() => setEditOpen(true)}>State:\n                    <Box key={'in'+input.toString()} data={input} /></div>\n                <div className='boxContainerInner'>Output:\n                    <Box key={'out'+input.toString()}\n                    data={getOutput(input)} />\n                </div>\n            </div>\n            {editOpen && \n            <div><div className='fadeBackground'\n            onClick={() => setEditOpen(false)}></div>\n            <div className='editBoxContainer'>\n                <EditBox initial={input} editHandler={(v) => {\n                    setInput(v);\n                }}/>\n            </div></div>\n            }\n        </div>\n    );\n}\n\nexport default MixColumnsPage;","import React, { useState } from 'react'\nimport Box from './Box.js'\nimport EditBox from './EditBox.js'\n\nfunction AddRoundKeyPage(props) {\n    const [editInputOpen, setEditInputOpen] = useState(false);\n    const [editKeyOpen, setEditKeyOpen] = useState(false);\n    const [input, setInput] = useState(props.input.data);\n    const [roundKey, setRoundKey] = useState(props.input.roundKey);\n\n    const getOutput = (a, b) => {\n        const output = new Array(a.length);\n        for(let i=0; i<a.length; i++)\n            output[i] = a[i]^b[i];\n        return output;\n    };    \n    \n\n    return (\n        <div className='page'>\n            <h2>Add Round Key</h2>\n            <p>One very easy final step - we simply need to XOR the state with the round key we generated. Both the input and round key boxes are editable here!</p>\n\n            <div className='boxContainerOuter'>\n                <div className='boxContainerInner' onClick={() => setEditInputOpen(true)}>State:\n                    <Box key={'in'+input.toString()+roundKey.toString()} data={input} /></div>\n                <div className='boxContainerInner' onClick={() => setEditKeyOpen(true)}>Round Key:\n                    <Box key={'in'+input.toString()+roundKey.toString()} data={roundKey} /></div>\n                <div className='boxContainerInner'>Output\n                    <Box key={'out'+input.toString()+roundKey.toString()}\n                    data={getOutput(input, roundKey)} />\n                </div>\n            </div>\n            {editInputOpen && \n            <div><div className='fadeBackground'\n            onClick={() => setEditInputOpen(false)}></div>\n            <div className='editBoxContainer'>\n                <EditBox initial={input} editHandler={(v) => {\n                    setInput(v);\n                }}/>\n            </div></div>\n            }\n            {editKeyOpen && \n                <div><div className='fadeBackground'\n                onClick={() => setEditKeyOpen(false)}></div>\n                <div className='editBoxContainer'>\n                    <EditBox initial={roundKey} editHandler={(v) => {\n                        setRoundKey(v);\n                    }}/>\n                </div></div>\n            }\n        </div>\n    );\n}\n\nexport default AddRoundKeyPage;","import React, { useState } from 'react';\nimport './App.css';\nimport AboutPage from './About.js';\nimport FirstPage from './First.js';\nimport SubBytesPage from './SubBytes.js';\nimport ShiftRowsPage from './ShiftRows.js';\nimport MixColumnsPage from './MixColumns.js';\nimport AddRoundKeyPage from './AddRoundKey.js';\n\n\nfunction App() {\n  document.title = 'Interactive AES - asg58';\n  const KatexCssInclude = document.createElement('link');\n  KatexCssInclude.href=\"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css\";\n  KatexCssInclude.rel=\"stylesheet\";\n  document.head.appendChild(KatexCssInclude);\n  const Latex = require('react-latex');\n\n  //We are building the state matrix the wrong way round\n  //Just fill it out and transpose for the sake of sanity..\n\n  //Should be 257, but threw an error once and I'm cautious now...\n  const data = () => Array.from({length: 16}, () => Math.floor(Math.random() * 256));\n\n  const [page, setPage] = useState('about');\n  const pageObjects = { \n    'about': <AboutPage className={'page'} tex={Latex} />,\n    'first': <FirstPage className={'page'} input={data()} tex={Latex} />,\n    'subBytes': <SubBytesPage className={'page'} input={data()} tex={Latex} />,\n    'shiftRows': <ShiftRowsPage className={'page'} input={data()} tex={Latex} />,\n    'mixCols': <MixColumnsPage className={'page'} input={data()} tex={Latex} />,\n    'addRoundKey': <AddRoundKeyPage className={'page'} input={{data: data(), roundKey: data()}} tex={Latex} />\n  };\n\n  return (\n    <>\n      <div class='topNav'>\n        <div class='navElt' onClick={() => setPage('about')}>About</div>\n        <div class='navElt' onClick={() => setPage('first')}>Prerequisites</div>\n        <div class='navElt' onClick={() => setPage('subBytes')}>SubBytes</div>\n        <div class='navElt' onClick={() => setPage('shiftRows')}>ShiftRows</div>\n        <div class='navElt' onClick={() => setPage('mixCols')}>MixCols</div>\n        <div class='navElt' onClick={() => setPage('addRoundKey')}>AddRoundKey</div>\n      </div>\n\n      {<div id='main'>{pageObjects[page]}</div>}\n      \n    </>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport './TorTalk.css';\nimport { Link } from 'react-router-dom';\n\nfunction TorTalk() {\n    document.title = 'Interactive AES - asg58';\n\n    return (\n        <>\n        <div id='back'><Link to='' >Take me back</Link></div>\n        <div id='main'>\n            <h1>I'm a hidden service too!</h1> \n            <p>So, your government wants to stop you viewing this random student's information page about AES. You know you're under surveilance, but you need your fix... What do you do? You go <b>darkweb</b>.</p>\n\n            <p>I decided to set a parallel site up to this as a hidden service for a couple of reasons. Firstly, I bought a new phone over a year ago, and while the previous one was murdering batteries like crazy, it was perfectly fine while plugged in - so why not turn it into a server and have it do something interesting? Second, it's an opportunity to learn something cool - so this page documents the process of setting this all up.</p>\n\n            <h2>What is Tor?</h2>\n            <p>This isn't intended to be an explanation of what Tor is or how it works, but take a look at <a href='https://2019.www.torproject.org/about/overview.html.en' target='_blank' rel='noopener noreferrer' >their website</a> for more info. <a href='https://2019.www.torproject.org/docs/onion-services' target='_blank' rel='noopener noreferrer' >Hidden services</a>, (now known as onion services) are sites that are accessible only over the Tor network, and as such provide a high level of annonymity.</p>\n\n            <h2>Setting up the hardware</h2>\n            <p>I'm using a Huawei/Google Nexus 6P (development name angler). This is still a good phone! Mine happened to develop a hardware fault out of warranty which forced me to replace it, but the specs are still pretty solid, and it can certainly handle the very occasional request as a server. Since it's a phone it's got a nice low power usage, and is pretty comfortable running for weeks on end. </p>\n            <p>Let's start by degoogling the thing. For all the good things Google does, if we want this thing to stay underground we don't want it <a href='https://www.theverge.com/2017/11/21/16684818/google-location-tracking-cell-tower-data-android-os-firebase-privacy' target='_blank' rel='noopener noreferrer' >phoning home like crazy.</a> If we really want to secure this, we'd also gut the sim and wifi hardware, and plug the phone into a wired connection with an adapter to the USB-C port; seeing as I'd rather not kill this phone just for that, I won't be going this far.</p>\n            <p>What we do want to do is flash a non-stock ROM. I'm going with <a href='https://lineageos.org/' target='_blank' rel='noopener noreferrer' >Lineage OS</a>, for no reason other than that I'm used to it. The Nexus 6P is no longer officially supported by the Lineage team, but there is a user on the XDA forums still building and packaging for it - a big thank you to <a href='https://forum.xda-developers.com/member.php?s=fb3b2939285c086e531518642897e530&u=8086838' target='_blank' rel='noopener noreferrer' >PixelBoot!</a> (Yes, we don't know if we can trust him, but he's a well-respected user - if we're hosting something real, we absolutely build it ourselves!)</p>\n            <p>The process is the same as for any Android custom ROM; unlock the bootloader with adb and fastboot, install a custom recovery, and install Lineage from this. PixelBoot has given a pretty solid tutorial for my device, and if you're doing this on a device with Lineage support, by all means follow those instructions. I wanted root access, (though it's safer not to have it and you don't need it for any of this) so I rooted it at this point of the process. <b>The whole point of this is that we are not installing GApps.</b> If Google don't have any software on our phone, they can't know anything (...is the hope).</p>\n            \n            <h2>Setting up the software</h2> \n            <p>So how do we serve from this thing? I signed the phone in to my home wifi, sideloaded <a href='https://f-droid.org/' target='_blank' rel='noopener noreferrer' >F-Droid</a>, and installed <a href='https://f-droid.org/en/packages/com.termux/' target='_blank' rel='noopener noreferrer' >Termux</a> through this. Termux is amazing, and gives us access to everything we need. It'll be much easier to work with this on a computer with a proper keyboard, so the last thing we'll do on the phone is to install the openssh package in Termux and start it, with the lines: </p>\n            <code className='codeBlock'>pkg install openssh<br />sshd</code>\n            <p>When we're done and want to kill the server, stop it with <code>pkill sshd</code></p>\n            <p>Make sure your computer is on the same local network as the phone, grab the phone's IP with <code>ifconfig</code>, the current user with <code>whoami</code>, set the password with <code>passwd</code>, and ssh in! (The Termux openssh package defaults to serving on port 8022)</p>\n\n            <code className='codeBlock' >[louie@ltp ~]$ ssh u0_a104@192.168.1.73 -p 8022<br />\nu0_a104@192.168.1.73's password: <br />\n<br />\nWelcome to Termux!<br />\n<br />\nWiki:            https://wiki.termux.com<br />\nCommunity forum: https://termux.com/community<br />\nGitter chat:     https://gitter.im/termux/termux<br />\nIRC channel:     #termux on freenode<br />\n<br />\nWorking with packages:<br />\n<br />\n * Search packages:   pkg search &lt;query&gt;<br />\n * Install a package: pkg install &lt;package&gt;<br />\n * Upgrade packages:  pkg upgrade<br />\n <br />\nSubscribing to additional repositories:<br />\n<br />\n * Root:     pkg install root-repo<br />\n * Unstable: pkg install unstable-repo<br />\n * X11:      pkg install x11-repo<br />\n <br />\nReport issues at https://termux.com/issues<br />\n<br />\n$ <br />\n\n            </code>\n            <p>Now things should be a lot easier! To get a hidden service up and running, we'll need the <code>tor</code> package on the phone. Grab this with <code>pkg</code>. We'll need content to serve too, so I've grabbed <code>git</code> so I can clone my repository straight down. And most importantly, we need a server - <code>nginx</code> is nice and small, so I've gone with that. </p>\n            <code className='codeBlock'>pkg install nginx git tor vim</code>\n            <p>It's worth noting that <code  className='codePath'>/data/data/com.termux/files/usr/</code> has the structure we'd usually expect to be found at  <code className='codePath'>/</code> .</p>\n            <p>Confirm that nginx is working properly, and then go into the nginx config to set it to only listen on the localhost interface (this stops 'just anyone' from connecting, unless they're coming through the Tor network). Now edit torrc (<code  className='codePath'>/data/data/com.termux/files/usr/etc/tor/torrc</code>) to add the following: </p>\n\n            <code className='codeBlock'>\n            HiddenServiceDir /var/lib/tor/hidden_service/<br />\n            HiddenServicePort 80 127.0.0.1:8080\n            </code>\n\n            <p>This points port 80 on the public-facing tor service to port 8080 on our local server. To check what address we need to publicise, we check <code className='codePath'>/data/data/code.termux/files/usr/var/lib/tor/hidden_service/hostname</code>: in this case, we're at <code>ca2m4yev3ofg5kt6ywbtzaf2cvlfg26ox5blwvfx6dbj4g3k2iczguqd.onion</code></p>\n            <p>Now boot Tor on the phone, and we should be able to see the intro page through Tor. From here, I cloned the git repository of my page, copied the build folder to <code className='codePath'>/data/data/com.termux/files/usr/share/aes</code>, and pointed nginx at it from nginx.conf - from here, we should be good to go! For a proper production build, to keep the site hidden, you'd need to spend some time hardening nginx to stop it leaking info, but this is the basics done.</p>\n            <p>Side note: restarting things is a bit awkward here - I found myself resorting to finding the nginx process with <code>ps -e</code> and killing it with <code>kill</code>, before restarting it manually.</p>\n        </div>\n        </>\n    );\n}\n\nexport default TorTalk;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport TorTalk from './TorTalk.js';\nimport * as serviceWorker from './serviceWorker';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link\n} from 'react-router-dom'\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router>\n      <Switch>\n        <Route path='/tor' >\n          <TorTalk />\n        </Route>\n        <Route path='/' >\n          <App />\n        </Route>\n      </Switch>\n      <footer>Clearnet: <a href='https://asg58.user.srcf.net'>asg58.user.srcf.net</a>. Tor: ca2m4yev3ofg5kt6ywbtzaf2cvlfg26ox5blwvfx6dbj4g3k2iczguqd.onion. <Link to='/tor' >What is this?</Link></footer>\n    </Router>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}